(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{"0342":function(e,t,a){},"1c1e":function(e,t,a){"use strict";a("386d"),a("4917"),a("3b2b"),a("c5f6"),a("cadf"),a("551c"),a("097d");var n=a("7f43"),i=a.n(n),o=a("4328"),l=a.n(o);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e=Number(e),!e||"number"!=typeof e||isNaN(e))throw Error("errCode is not exist, please check it");return e}function r(e){if(window.postMessage){var t=null;try{try{t=JSON.stringify(e)}catch(a){t=null}window.parent.postMessage(t,"*")}catch(a){alert(a)}}}function c(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null}function f(){return c("token")}var d={timeout:9e4,headers:{"Content-Type":"application/json"}};var p=i.a.create(d);p.interceptors.request.use(function(e){return e.data.token=f(),"application/json"!==e.headers["Content-Type"]&&(e.data=l.a.stringify(e.data)),e}),p.interceptors.response.use(function(e){var t=e.data;if(!t.errCode)return t;var a=s(t.errCode);switch(a){case 200:return t;default:return r(t),Promise.reject(t)}},function(e){if(e.response){var t=e.response,a=t.status,n=t.data;return 200===a&&window.location.href,403===a&&window.location.href,Promise.reject(n)}return Promise.reject(e)}),t["a"]=p.post},"2ccb":function(e,t,a){"use strict";var n=a("0342"),i=a.n(n);i.a},"5c37":function(e,t,a){var n={"./af":"414e","./af.js":"414e","./ar":"f47b","./ar-dz":"5da3","./ar-dz.js":"5da3","./ar-kw":"9197","./ar-kw.js":"9197","./ar-ly":"1490","./ar-ly.js":"1490","./ar-ma":"5b78","./ar-ma.js":"5b78","./ar-sa":"c086","./ar-sa.js":"c086","./ar-tn":"5f0d","./ar-tn.js":"5f0d","./ar.js":"f47b","./az":"b515","./az.js":"b515","./be":"76e7","./be.js":"76e7","./bg":"6152","./bg.js":"6152","./bm":"6166","./bm.js":"6166","./bn":"0fc7","./bn.js":"0fc7","./bo":"6d8b","./bo.js":"6d8b","./br":"66e2","./br.js":"66e2","./bs":"25eb","./bs.js":"25eb","./ca":"51da","./ca.js":"51da","./cs":"7fb4","./cs.js":"7fb4","./cv":"5c9c","./cv.js":"5c9c","./cy":"9d33","./cy.js":"9d33","./da":"6aed","./da.js":"6aed","./de":"51ba","./de-at":"20d6","./de-at.js":"20d6","./de-ch":"a1a0","./de-ch.js":"a1a0","./de.js":"51ba","./dv":"5cf0","./dv.js":"5cf0","./el":"c75d","./el.js":"c75d","./en-au":"54ae","./en-au.js":"54ae","./en-ca":"b17c","./en-ca.js":"b17c","./en-gb":"ddb8","./en-gb.js":"ddb8","./en-ie":"fcfe","./en-ie.js":"fcfe","./en-il":"fb92","./en-il.js":"fb92","./en-nz":"8844","./en-nz.js":"8844","./eo":"4991","./eo.js":"4991","./es":"4f02","./es-do":"1f4a","./es-do.js":"1f4a","./es-us":"a711","./es-us.js":"a711","./es.js":"4f02","./et":"ece8","./et.js":"ece8","./eu":"836a","./eu.js":"836a","./fa":"20de","./fa.js":"20de","./fi":"b4e9","./fi.js":"b4e9","./fo":"e4d2","./fo.js":"e4d2","./fr":"c30b","./fr-ca":"394e","./fr-ca.js":"394e","./fr-ch":"0149","./fr-ch.js":"0149","./fr.js":"c30b","./fy":"f76e","./fy.js":"f76e","./gd":"5849","./gd.js":"5849","./gl":"f22b","./gl.js":"f22b","./gom-latn":"16c5","./gom-latn.js":"16c5","./gu":"194d","./gu.js":"194d","./he":"d36f","./he.js":"d36f","./hi":"9c6f","./hi.js":"9c6f","./hr":"0cb3","./hr.js":"0cb3","./hu":"f15f","./hu.js":"f15f","./hy-am":"2123","./hy-am.js":"2123","./id":"34ec","./id.js":"34ec","./is":"7784","./is.js":"7784","./it":"0fbb","./it.js":"0fbb","./ja":"3470","./ja.js":"3470","./jv":"da9a","./jv.js":"da9a","./ka":"4bde","./ka.js":"4bde","./kk":"1bad","./kk.js":"1bad","./km":"6289","./km.js":"6289","./kn":"e5c0","./kn.js":"e5c0","./ko":"eada","./ko.js":"eada","./ky":"f204","./ky.js":"f204","./lb":"fcf6","./lb.js":"fcf6","./lo":"ee17","./lo.js":"ee17","./lt":"508e","./lt.js":"508e","./lv":"5bbe","./lv.js":"5bbe","./me":"5c70","./me.js":"5c70","./mi":"d4a2","./mi.js":"d4a2","./mk":"617d","./mk.js":"617d","./ml":"95db","./ml.js":"95db","./mn":"8636","./mn.js":"8636","./mr":"fd58","./mr.js":"fd58","./ms":"3fe9","./ms-my":"7540","./ms-my.js":"7540","./ms.js":"3fe9","./mt":"c3f6","./mt.js":"c3f6","./my":"2fce","./my.js":"2fce","./nb":"c48e","./nb.js":"c48e","./ne":"efe0","./ne.js":"efe0","./nl":"a99f","./nl-be":"e75d","./nl-be.js":"e75d","./nl.js":"a99f","./nn":"3e6f","./nn.js":"3e6f","./pa-in":"a453","./pa-in.js":"a453","./pl":"1d34","./pl.js":"1d34","./pt":"340b","./pt-br":"d201","./pt-br.js":"d201","./pt.js":"340b","./ro":"7ed8","./ro.js":"7ed8","./ru":"29e5","./ru.js":"29e5","./sd":"4e43","./sd.js":"4e43","./se":"8c6a","./se.js":"8c6a","./si":"8e89","./si.js":"8e89","./sk":"5a30","./sk.js":"5a30","./sl":"0bc1","./sl.js":"0bc1","./sq":"5f82","./sq.js":"5f82","./sr":"b37a","./sr-cyrl":"1771","./sr-cyrl.js":"1771","./sr.js":"b37a","./ss":"f954","./ss.js":"f954","./sv":"8f23","./sv.js":"8f23","./sw":"5a75","./sw.js":"5a75","./ta":"76f5","./ta.js":"76f5","./te":"4ad8","./te.js":"4ad8","./tet":"63e7","./tet.js":"63e7","./tg":"fe85","./tg.js":"fe85","./th":"625e","./th.js":"625e","./tl-ph":"3f6c","./tl-ph.js":"3f6c","./tlh":"81fe","./tlh.js":"81fe","./tr":"e8b2","./tr.js":"e8b2","./tzl":"43a5","./tzl.js":"43a5","./tzm":"ad04","./tzm-latn":"3fd8","./tzm-latn.js":"3fd8","./tzm.js":"ad04","./ug-cn":"4d04","./ug-cn.js":"4d04","./uk":"330e","./uk.js":"330e","./ur":"e7e8","./ur.js":"e7e8","./uz":"17ef","./uz-latn":"0eb0","./uz-latn.js":"0eb0","./uz.js":"17ef","./vi":"84e0","./vi.js":"84e0","./x-pseudo":"86ab","./x-pseudo.js":"86ab","./yo":"3f53","./yo.js":"3f53","./zh-cn":"622a","./zh-cn.js":"622a","./zh-hk":"8fd9","./zh-hk.js":"8fd9","./zh-tw":"e240","./zh-tw.js":"e240"};function i(e){var t=o(e);return a(t)}function o(e){var t=n[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id="5c37"},"5e4e":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("div",{staticClass:"page-body"},[a("div",{staticClass:"search"},[a("el-form",{ref:"form",staticClass:"create-desktop",attrs:{model:e.fields,inline:""}},[a("el-form-item",{attrs:{label:"账单类型："}},[a("el-select",{model:{value:e.fields.type,callback:function(t){e.$set(e.fields,"type",t)},expression:"fields.type"}},e._l(e.relativeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),"self"===e.fields.type?a("el-form-item",{attrs:{label:"用户："}},[a("el-input",{attrs:{type:"text",placeholder:"请输入名字",clearable:""},model:{value:e.selfTableConfig.condition.userId,callback:function(t){e.$set(e.selfTableConfig.condition,"userId",t)},expression:"selfTableConfig.condition.userId"}})],1):e._e(),a("el-form-item",{attrs:{label:"月份:"}},[a("el-select",{attrs:{placeholder:"请选择日期"},model:{value:e.fields.date,callback:function(t){e.$set(e.fields,"date",t)},expression:"fields.date"}},e._l(e.dateList,function(t,n){return a("el-option",{key:n,attrs:{value:t}},[e._v(e._s(t))])}))],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"department"===e.fields.type,expression:"fields.type === 'department'"}]},[a("el-input",{attrs:{clearable:!0,placeholder:"请点击筛选部门",readonly:""},nativeOn:{click:function(t){return e.openOuDialog(t)}},model:{value:e.fields.selectNode.title,callback:function(t){e.$set(e.fields.selectNode,"title",t)},expression:"fields.selectNode.title"}})],1),a("el-form-item",[a("el-button",{attrs:{loading:e.loading},on:{click:e.search}},[e._v("搜索")])],1)],1)],1),a("div",{staticClass:"content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"department"===e.fields.type,expression:"fields.type === 'department'"}],staticClass:"chart"},[e.lineOptions.series&&e.lineOptions.series.data&&e.lineOptions.series.data.length>0?a("pie",{attrs:{options:e.lineOptions}}):a("div",{staticStyle:{height:"300px","line-height":"300px","text-align":"center"}},[a("span",[e._v("图暂无数据")])]),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.stack.length>0,expression:"stack.length > 0"}],attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.toBefore(t)}}},[e._v("返回上一级")])],1)],1),a("table-temp",{directives:[{name:"show",rawName:"v-show",value:"self"===e.fields.type,expression:"fields.type === 'self'"}],ref:"selfTable",attrs:{loading:e.loading,config:e.selfTableConfig},on:{"update:loading":function(t){e.loading=t}}})],1)]),a("el-dialog",{attrs:{title:"选择",visible:e.showOuDialog,width:"60%"},on:{"update:visible":function(t){e.showOuDialog=t}}},[a("el-tree",{staticClass:"h500",attrs:{props:e.treeProps,lazy:"",load:e.loadNode},on:{"node-click":e.handleNodeClick}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showOuDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showOuDialog=!1}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"详情",visible:e.showDeparmentTableDialog,width:"70%"},on:{"update:visible":function(t){e.showDeparmentTableDialog=t}}},[a("div",{staticClass:"table",staticStyle:{padding:"0 20px"}},[a("div",{staticClass:"chart-detail-title"},[a("h3",[e._v(e._s(e.currentDepartment.name))]),a("div",[a("span",[e._v("总金额:")]),a("span",[e._v(e._s(e.money)+"元")])]),a("div",[a("span",[e._v("总时长:")]),a("span",[e._v(e._s(e.time)+"小时")])])]),a("table-temp",{ref:"departmentTable",attrs:{config:e.departmenTableConfig}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showDeparmentTableDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showDeparmentTableDialog=!1}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"选择",visible:e.showSelfTableDialog,width:"60%"},on:{"update:visible":function(t){e.showSelfTableDialog=t}}},[a("table-temp",{ref:"selfTableDetail",attrs:{config:e.selfTableDetailConfig}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showSelfTableDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showSelfTableDialog=!1}}},[e._v("确 定")])],1)],1)],1)},i=[],o=(a("ac6a"),a("cadf"),a("551c"),a("097d"),a("1c1e")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"h100"},[a("div",{ref:"lineChart",staticClass:"h100"})])},s=[],r=(a("456d"),a("b8f0")),c=a("f3d1");a("0b09"),a("eace"),a("7285"),a("6ac1");var f={name:"echartPie",props:{options:{type:Object,required:!0}},data:function(){return{myChart:null,baseOptions:{tooltip:{trigger:"item"},series:[],toolbox:{left:"center",feature:{saveAsImage:{}}}},defaultColor:{itemStyle:[{normal:{color:"rgba(33,150,243,0.5)"}},{normal:{color:"rgba(183,28,28,0.5)"}},{normal:{color:"rgba(129, 227, 238, 0.8)"}}],areaStyle:{normal:{color:new c.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(149,40,180,0.5)"},{offset:1,color:"rgba(149,40,180,0.5)"}])}}}}},watch:{options:function(){this.refresh(this.options)}},methods:{init:function(){this.myChart=c.init(this.$refs.lineChart)},setOptions:function(e){this.myChart.setOption(e),this.myChart.off("click"),this.myChart.on("click",this.options.clickFn)},refresh:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log(this.myChart),this.myChart.clear(),e=Object(r["b"])({},this.baseOptions,e),console.log(e),this.setOptions(e)},addColor:function(e){var t=this;Object.keys(e).forEach(function(a){"series"==a&&(Object(r["c"])(e[a],"object")?(e[a].areaStyle||(e[a].areaStyle=t.defaultColor.areaStyle),e[a].itemStyle||(e[a].itemStyle=t.defaultColor.itemStyle[0])):Object(r["c"])(e[a],"array")&&e[a].forEach(function(e){e.areaStyle||(e.areaStyle=t.defaultColor.areaStyle),e.itemStyle||(e.itemStyle=t.defaultColor.itemStyle)}))})}},mounted:function(){var e=this;this.$nextTick(function(){e.init(),e.refresh(e.options)})}},d=f,p=(a("dd5b"),a("2877")),h=Object(p["a"])(d,l,s,!1,null,"7ef96cfc",null);h.options.__file="pie.vue";var g=h.exports,u={data:function(){return{lineOptions:{},stack:[],currentDepartment:{name:"",money:"",time:""}}},methods:{getChartData:function(){var e=this,t={date:this.fields.date,ou:this.departmenTableConfig.condition.departmentOU};this.loading=!0,Object(o["a"])("".concat(window.IP_CONFIG.billSite,"/bill/departmentBill"),t).then(function(t){t&&t.data?t.data.length>0?1===t.data.length&&e.departmenTableConfig.condition.departmentOU===t.data[0].departmentOU?(e.showDeparmentTableDialog=!0,e.$nextTick(function(){e.$refs.departmentTable.fetch()})):(e.lineOptions=e.chartDataFormatter(t.data),-1===e.stack.indexOf(e.departmenTableConfig.condition.departmentOU)&&e.stack.push(e.departmenTableConfig.condition.departmentOU)):e.getTableData():t&&!t.data?e.getTableData():e.$message.error("获取出错")}).finally(function(){e.loading=!1})},chartDataFormatter:function(e){var t=this,a="".concat(this.fields.date,"部门消耗金额统计账单");return{clickFn:function(a){var n=e[a.dataIndex];t.currentDepartment.name=n.departmentName,t.departmenTableConfig.condition.departmentOU=n.departmentOU,t.getChartData()},title:{text:a},series:{name:a,type:"pie",radius:"55%",center:["50%","50%"],data:e.map(function(e){return{value:e.totalMoney,name:e.departmentName}}),animationType:"scale",animationEasing:"elasticOut",animationDelay:function(){return 200*Math.random()}}}},toBefore:function(){var e=this.stack.shift();this.departmenTableConfig.condition.departmentOU=e,this.getChartData()},getTableData:function(){var e=this;this.stack.length>0?(this.showDeparmentTableDialog=!0,this.$nextTick(function(){e.stack.length>0&&(e.$refs.departmentTable.fetch(),-1!==e.stack.indexOf(e.departmenTableConfig.condition.departmentOU)&&e.stack.shift())})):(this.$message.warning("暂无数据"),this.lineOptions=this.chartDataFormatter([]))}},mounted:function(){}},b=a("8efb"),m={name:"BillAnalysis",components:{Pie:g,TableTemp:b["a"]},mixins:[u],watch:{"fields.selectNode":function(){this.departmenTableConfig.condition.departmentOU=this.fields.selectNode.dn||"",this.selfTableConfig.condition.ou=this.fields.selectNode.dn||"",this.stack=[]},"fields.date":function(){this.departmenTableConfig.condition.billDate=this.fields.date||"",this.selfTableDetailConfig.condition.billDate=this.fields.date||"",this.selfTableConfig.condition.date=this.fields.date||""}},computed:{money:function(){var e=0;return this.departmenTableConfig.tableData.forEach(function(t){e+=t.totalMoney||0}),e.toFixed(2)},time:function(){var e=0;return this.departmenTableConfig.tableData.forEach(function(t){e+=t.totalTime||0}),e}},data:function(){var e=this;return{loading:!1,dateList:[],fields:{type:"department",date:"",ou:"",userName:"",selectNode:{}},relativeList:[{value:"department",label:"部门账单"},{value:"self",label:"个人账单"}],departmenTableConfig:{tableData:[],tableSetting:[{label:"用户名",prop:"userName"},{label:"虚拟机名称",prop:"machineName"},{label:"配置",prop:"machineInfo"},{label:"时长（h）",prop:"totalTime"},{label:"金额（￥）",prop:"totalMoney"}],condition:{departmentOU:"",billDate:""},page:{pageIndex:1,pageSize:10,total:0,pageSizes:[10,20,30,50],map:{index:"page",size:"pageSize"}},map:{children:"items"},fetchUrl:"".concat(window.IP_CONFIG.billSite,"/bill/departmentBillDetail")},selfTableConfig:{tableData:[],tableSetting:[{label:"姓名",prop:"userName"},{label:"部门",prop:"department"},{label:"登录总时长(h)",prop:"totalTime"},{label:"总金额(元)",prop:"totalMoney"}],condition:{date:"",userId:null},page:{pageIndex:1,pageSize:10,total:0,pageSizes:[10,20,30,50],map:{index:"page",size:"pageSize"}},operation:{btns:[{label:"详情",fn:function(t){e.showSelfTableDialog=!0,e.getselfTableDetail(t)}}]},map:{children:"items"},fetchUrl:"".concat(window.IP_CONFIG.billSite,"/bill/personBill")},selfTableDetailConfig:{tableData:[],tableSetting:[{label:"日期",prop:"date"},{label:"虚拟机名称",prop:"machineName"},{label:"配置",prop:"machineInfo"},{label:"时长(h)",prop:"totalTime"},{label:"金额(￥)",prop:"totalMoney"}],condition:{userId:"",departmentOU:"",billDate:""},page:{pageIndex:1,pageSize:10,total:0,pageSizes:[10,20,30,50],map:{index:"page",size:"pageSize"}},map:{children:"items"},fetchUrl:"".concat(window.IP_CONFIG.billSite,"/bill/personBillDetail")},treeRoot:[],treeProps:{label:"title"},showOuDialog:!1,showDeparmentTableDialog:!1,showSelfTableDialog:!1}},methods:{openOuDialog:function(){this.showOuDialog=!0},search:function(){var e=this;this.fields.date?(this.stack=[],this.departmenTableConfig.condition.departmentOU=this.fields.selectNode.dn||"","department"===this.fields.type?(this.stack=[],this.getChartData()):this.$nextTick(function(){e.$refs.selfTable.fetch()})):this.$message.error("请选择时间")},getDateList:function(){var e=this;Object(o["a"])("".concat(window.IP_CONFIG.billSite,"/bill/getDateSheet"),{type:1}).then(function(t){e.dateList=t?t.data:[],e.fields.date=e.dateList.length>0?e.dateList[0]:""})},handleNodeClick:function(e){this.fields.selectNode=e},loadNode:function(e,t){0===e.level?Object(o["a"])("".concat(window.IP_CONFIG.billSite,"/bill/getAdDepartment"),{dn:""}).then(function(e){t(e.data)}):Object(o["a"])("".concat(window.IP_CONFIG.billSite,"/bill/getAdDepartment"),{dn:e.data.dn||""}).then(function(e){t(e.data)})},getDepartmentChartTable:function(){this.$refs.table.fetch()},getselfTableDetail:function(e){var t=this;this.selfTableDetailConfig.condition.userId=e.userId||"",this.selfTableDetailConfig.condition.departmentOU=e.departmentOU||"",this.$nextTick(function(){t.$refs.selfTableDetail.fetch()})}},created:function(){this.getDateList()}},v=m,C=(a("2ccb"),Object(p["a"])(v,n,i,!1,null,"7e0cc92d",null));C.options.__file="main.vue";t["a"]=C.exports},7563:function(e,t,a){"use strict";var n=a("b6e2"),i=a.n(n);i.a},"8efb":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"tableTempWrap",staticClass:"table-temp"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"farm-table-temp",attrs:{loadingText:"正在加载表格数据",data:e.cloneConfig.tableData,border:"",stripe:"",size:"small"},on:{"selection-change":e.handleSelectionChange}},[e.cloneConfig.selection?a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}):e._e(),e.cloneConfig.serialNumber?a("el-table-column",{attrs:{type:"index",align:"center",width:"55"}}):e._e(),e._l(e.cloneConfig.tableSetting,function(t,n){return a("el-table-column",{key:n,staticClass:"column",attrs:{label:t.label,prop:t.prop,align:"center","min-width":t.minWidth||120,fixed:t.fixed,"show-overflow-tooltip":"",sortable:t.sortable||!1},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t(t.slot,[e._v("\n          "+e._s("function"===typeof t.formatter?t.formatter(a.row,a.column,a.row[t.prop],n):a.row[t.prop])+"\n        ")],{row:a.row})]}}])})}),e.cloneConfig.operation?a("el-table-column",{attrs:{align:"center",fixed:e.cloneConfig.operation.fixed||"right",label:e.cloneConfig.operation.label||"操作","min-width":e.cloneConfig.operation.minWidth||150,width:e.cloneConfig.operation.width},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.cloneConfig.operation.btns,function(n,i){return("function"===typeof n.show?n.show(t.row):!1!==n.show)?a("el-button",{key:i,attrs:{disabled:!!n.disabled&&("function"===typeof n.disabled?n.disabled(t.row):!1!==n.disabled),size:n.size||"mini",type:n.type||"default"},on:{click:function(e){n.fn(t.row)}}},[n.href?a("a",{style:"function"===typeof n.style?n.style(t.row):n.style,attrs:{href:n.href}},[e._v("\n            "+e._s("function"===typeof n.label?n.label(t.row):n.label)+"\n          ")]):a("span",{style:"function"===typeof n.style?n.style(t.row):n.style},[e._v("\n            "+e._s("function"===typeof n.label?n.label(t.row):n.label)+"\n          ")])]):e._e()})}}])}):e._e()],2),e.cloneConfig.page?a("div",{ref:"reportNav",staticClass:"report-nav"},[a("el-pagination",{attrs:{"current-page":e.cloneConfig.page.pageIndex,"page-size":e.cloneConfig.page.pageSize,"page-sizes":e.cloneConfig.page.pageSizes,layout:e.layout,total:e.cloneConfig.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.cloneConfig.page,"pageIndex",t)}}})],1):e._e()],1)},i=[],o=a("be94"),l=a("b8f0"),s=a("1c1e"),r={name:"TableTemp",props:{config:{type:Object,require:!0},loading:{type:Boolean,require:!1}},data:function(){return{showSelectList:!1,cloneConfig:{},layout:"prev, pager, next, jumper",clientMaxHeight:200,isSizeOrIndexChange:!1}},watch:{"config.tableData":function(){this.init()}},methods:{getLayout:function(){this.cloneConfig.page&&this.cloneConfig.page.pageSizes&&(this.layout="sizes, "+this.layout),this.cloneConfig.page&&(0===this.cloneConfig.page.total||this.cloneConfig.page.total)&&(this.layout="total, "+this.layout)},switchLabel:function(e){e.necessary||(e.visible=!e.visible)},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)},handleSizeChange:function(e){this.cloneConfig.page&&(this.cloneConfig.page.pageSize=e,this.cloneConfig.page.pageIndex=1,this.isSizeOrIndexChange=!0),this.cloneConfig.fetchUrl&&this.cloneConfig.page?this.fetch():this.cloneConfig.page&&this.splitData()},handleCurrentChange:function(e){this.cloneConfig.page&&(this.cloneConfig.page.pageIndex=e,this.isSizeOrIndexChange=!0),this.cloneConfig.fetchUrl&&this.cloneConfig.page?this.fetch():this.cloneConfig.page&&this.splitData()},fetch:function(){var e=this;if(this.cloneConfig.fetchUrl)try{this.resetIndex();var t=Object(o["a"])({},this.cloneConfig.condition);if(this.cloneConfig.page){var a="pageSize",n="pageIndex";this.cloneConfig.page.map&&(a=this.cloneConfig.page.map.size||"pageSize",n=this.cloneConfig.page.map.index||"pageIndex"),t[a]=this.cloneConfig.page.pageSize||15,t[n]=this.cloneConfig.page.pageIndex||1}this.$emit("update:loading",!0);var i=Object(s["a"])(this.config.fetchUrl,t);i.then(function(t){var a=e.cloneConfig.map&&e.cloneConfig.map.children?e.cloneConfig.map.children:"list",n=e.cloneConfig.map&&e.cloneConfig.map.total?e.cloneConfig.map.total:"total";if(t.data&&t.data[a]&&t.data[a].length>0)e.cloneConfig.tableData=t.data[a],e.cloneConfig.page&&e.$set(e.cloneConfig.page,"total",t.data[n]);else if(t[a]||t.items){var i=t[n]>=0?t[n]:t.items.length;e.cloneConfig.tableData=t[a]||t.items,e.cloneConfig.page&&e.$set(e.cloneConfig.page,"total",i)}else e.$message({message:"当前暂无数据",type:"error"}),e.clearData()},function(){e.clearData()}).finally(function(){e.$emit("afterFetch"),e.$emit("update:loading",!1)})}catch(l){this.$emit("update:loading",!1),console.log("%c%s","color: red",l)}else console.log("%c没有fetchUrl，请检查","color: red")},clearData:function(){this.cloneConfig.tableData=[],this.cloneConfig.page&&(this.cloneConfig.page.pageIndex=1)&&(this.cloneConfig.page.total=0)},resetIndex:function(){this.cloneConfig.page&&!this.isSizeOrIndexChange?(this.$set(this.cloneConfig.page,"pageIndex",1),this.isSizeOrIndexChange=!1):this.isSizeOrIndexChange=!1},getMaxHeight:function(){var e=this.$refs.tableTempWrap,t=this.$refs.reportNav;this.clientMaxHeight=e.clientHeight-(t?t.offsetHeight:0)},splitData:function(){var e=this.cloneConfig.page&&this.cloneConfig.page.pageIndex||1,t=this.cloneConfig.page?this.cloneConfig.page.pageSize||0:15,a=this.config.tableData.length>t?t:this.config.tableData.length;this.cloneConfig.tableData=this.config.tableData.slice((e-1)*t,(e-1)*t+a)},init:function(){!this.config.fetchUrl&&this.config.page?(this.cloneConfig=Object(l["a"])(this.config),this.splitData()):this.cloneConfig=this.config}},created:function(){this.init(),this.getLayout()}},c=r,f=(a("a676"),a("2877")),d=Object(f["a"])(c,n,i,!1,null,"f7fd3f0a",null);d.options.__file="table-temp.vue";t["a"]=d.exports},a18c:function(e,t,a){"use strict";var n=a("2b0e"),i=a("081a"),o=a("aa62"),l=a("5e4e");n["default"].use(i["a"]),t["a"]=new i["a"]({routes:[{path:"/",redirect:"/expenses-record"},{path:"/expenses-record",component:o["a"]},{path:"/self-bill",component:l["a"]}]})},a676:function(e,t,a){"use strict";var n=a("c3b9"),i=a.n(n);i.a},aa62:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("div",{staticClass:"page-body"},[a("div",{staticClass:"search"},[a("el-form",{ref:"form",attrs:{model:e.fields,inline:""}},[a("el-form-item",{attrs:{label:"账单类型："}},[a("el-select",{model:{value:e.fields.type,callback:function(t){e.$set(e.fields,"type",t)},expression:"fields.type"}},e._l(e.relativeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),"self"===e.fields.type?a("el-form-item",{attrs:{label:"用户："}},[a("el-input",{attrs:{type:"text",placeholder:"请输入名字",clearable:""},model:{value:e.selfTableConfig.condition.userId,callback:function(t){e.$set(e.selfTableConfig.condition,"userId",t)},expression:"selfTableConfig.condition.userId"}})],1):e._e(),a("el-form-item",[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dateList,callback:function(t){e.dateList=t},expression:"dateList"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"department"===e.fields.type,expression:"fields.type === 'department'"}]},[a("el-input",{staticClass:"select-tree",attrs:{type:"text",placeholder:"请点击筛选",readonly:"",clearable:""},nativeOn:{click:function(t){return e.openOuDialog(t)}},model:{value:e.fields.selectNode.title,callback:function(t){e.$set(e.fields.selectNode,"title",t)},expression:"fields.selectNode.title"}})],1),a("el-form-item",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"department"===e.fields.type,expression:"fields.type === 'department'"}],attrs:{loading:e.loading},on:{click:e.search}},[e._v("搜索")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"self"===e.fields.type,expression:"fields.type === 'self'"}],attrs:{loading:e.loading,disabled:0===e.dateList.length||!e.selfTableConfig.condition.userId},on:{click:e.search}},[e._v("\n            搜索\n          ")])],1)],1)],1),a("div",{staticClass:"content"},[a("table-temp",{directives:[{name:"show",rawName:"v-show",value:"department"===e.fields.type,expression:"fields.type === 'department'"}],ref:"table",attrs:{loading:e.loading,config:e.tableConfig},on:{"update:loading":function(t){e.loading=t}}}),a("table-temp",{directives:[{name:"show",rawName:"v-show",value:"self"===e.fields.type,expression:"fields.type === 'self'"}],ref:"selfTable",attrs:{loading:e.loading,config:e.selfTableConfig},on:{"update:loading":function(t){e.loading=t}}})],1)]),a("el-dialog",{attrs:{title:"选择",visible:e.showOuDialog,width:"60%"},on:{"update:visible":function(t){e.showOuDialog=t}}},[a("el-tree",{staticClass:"h500",attrs:{props:e.treeProps,lazy:"",load:e.loadNode},on:{"node-click":e.handleNodeClick}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showOuDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showOuDialog=!1}}},[e._v("确 定")])],1)],1)],1)},i=[],o=(a("cadf"),a("551c"),a("097d"),a("23d5")),l=a.n(o),s=a("8efb"),r=a("1c1e"),c={name:"ExpensesRecord",components:{TableTemp:s["a"]},data:function(){return{loading:!1,showOuDialog:!1,dateList:[],fields:{type:"department",ou:"",selectNode:{}},relativeList:[{value:"department",label:"部门账单"},{value:"self",label:"个人账单"}],tableConfig:{tableData:[],tableSetting:[{label:"部门",prop:"departmentName"},{label:"虚拟机名称",prop:"machineName"},{label:"配置",prop:"machineInfo"},{label:"总时长(小时)",prop:"totalTime"},{label:"总金额(元)",prop:"totalMoney"}],condition:{departmentOU:"",endDate:"",startDate:""},page:{pageIndex:1,pageSize:10,total:0,pageSizes:[10,20,30,50],map:{index:"page",size:"pageSize"}},map:{children:"items"},fetchUrl:"".concat(window.IP_CONFIG.billSite,"/bill/departmentSettlement")},selfTableConfig:{tableData:[],tableSetting:[{label:"时间",prop:"useTime"},{label:"虚拟机名称",prop:"machineName"},{label:"配置",prop:"machineInfo"},{label:"用时(小时)",prop:"totalTime"},{label:"金额(元)",prop:"totalMoney"}],condition:{endDate:"",startDate:"",userId:""},page:{pageIndex:1,pageSize:10,total:0,pageSizes:[10,20,30,50],map:{index:"page",size:"pageSize"}},map:{children:"items"},fetchUrl:"".concat(window.IP_CONFIG.billSite,"/bill/personBillRecord")},treeRoot:[],treeProps:{label:"title"}}},methods:{openOuDialog:function(){this.showOuDialog=!0},search:function(){this.dateList&&2===this.dateList.length?"department"===this.fields.type?this.getDepartmentStatement():this.getSelfTableData():this.$message.error("请选择时间")},getDepartmentStatement:function(){this.tableConfig.condition.departmentOU=this.fields.selectNode.dn||"",this.tableConfig.condition.startDate=this.dateList[0]?l()(this.dateList[0]).format("YYYY-MM-DD"):"",this.tableConfig.condition.endDate=this.dateList[1]?l()(this.dateList[1]).format("YYYY-MM-DD"):"",this.$refs.table.fetch()},getDepartmentDetail:function(e){this.tableConfig.condition.department=e.departmentName,this.tableConfig.condition.startDate=this.dateList[0]?l()(this.dateList[0]).format("YYYY-MM-DD"):"",this.tableConfig.condition.endDate=this.dateList[1]?l()(this.dateList[1]).format("YYYY-MM-DD"):"",this.$refs.table.fetch()},getSelfTableData:function(){this.selfTableConfig.condition.startDate=this.dateList[0]?l()(this.dateList[0]).format("YYYY-MM-DD"):"",this.selfTableConfig.condition.endDate=this.dateList[1]?l()(this.dateList[1]).format("YYYY-MM-DD"):"",this.$refs.selfTable.fetch()},handleNodeClick:function(e){this.fields.selectNode=e},loadNode:function(e,t){0===e.level?Object(r["a"])("".concat(window.IP_CONFIG.billSite,"/bill/getAdDepartment"),{dn:""}).then(function(e){t(e.data)}):Object(r["a"])("".concat(window.IP_CONFIG.billSite,"/bill/getAdDepartment"),{dn:e.data.dn||""}).then(function(e){t(e.data)})}}},f=c,d=(a("7563"),a("2877")),p=Object(d["a"])(f,n,i,!1,null,null,null);p.options.__file="main.vue";t["a"]=p.exports},b6e2:function(e,t,a){},b8f0:function(e,t,a){"use strict";a.d(t,"b",function(){return l}),a.d(t,"c",function(){return o}),a.d(t,"a",function(){return i});a("6b54"),a("a481"),a("3b2b");var n=a("53ca"),i=(a("cadf"),a("551c"),a("097d"),function e(t){if(null===t)return null;if("object"!==Object(n["a"])(t))return t;if(t.constructor===Date)return new Date(t);if(t.constructor===RegExp)return new RegExp(t);t.constructor();var a=new t.constructor;for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];a[i]="object"===Object(n["a"])(o)?e(o):o}return a});function o(e,t){if(t)return t=t.replace(/\w/,function(e){return e.toUpperCase()}),Object.prototype.toString.call(e)==="[object ".concat(t,"]");var a=Object.prototype.toString.call(e);return a.slice(8,-1).toLowerCase()}function l(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];if(!(t.length<=0)){var n=t.shift(),l=function e(t,a){if(!o(t,"object")||!o(a,"object"))return console.log(t,a),void console.log("[warining] %c this arguments of the merge function are not object","color: red");for(var n in a)!t.hasOwnProperty(n)&&a.hasOwnProperty(n)?t[n]=a[n]:a.hasOwnProperty(n)&&t.hasOwnProperty(n)&&o(a[n],"object")&&o(t[n])==o(a[n])?e(t[n],a[n]):t[n]=i(a[n])};while(t.length>0){var s=t.shift();l(n,s)}return n}}},c3b9:function(e,t,a){},dd5b:function(e,t,a){"use strict";var n=a("ed45"),i=a.n(n);i.a},ed45:function(e,t,a){}}]);